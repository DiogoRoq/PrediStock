<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestão de Produtos</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <div class="dashboard-container">
        
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="profile">
                <img src="imagem-usuario.png" alt="Icon" class="avatar">
                <p class="username">Usuário</p>
            </div>
            <nav class="menu">
                <button class="menu-item" onclick="location.href='dashboard.html'">Dashboard Principal</button>
                <button class="menu-item active-section" onclick="location.href='inventoryManagement.html'">Gestão de Produtos</button>
                <button class="menu-item" onclick="location.href='demandPrediction.html'">Previsão de Procura</button>
                <button class="menu-item" onclick="location.href='analytics.html'">Relatórios e Estatísticas</button>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="dashboard-content">
            <div class="content-header">
                <h2>Gestão de Produtos</h2>
                <p>Gerencie seus produtos abaixo.</p>
            </div>

            <div class="inventory-actions">
                <input type="text" placeholder="Pesquisar produto..." class="search-input">
                <button class="btn-primary" onclick="location.href='addProductForm.html'">Adicionar</button>
            </div>

            <div class="inventory-table">
                <table>
                    <thead>
                        <tr>
                            <th>SKU ID</th>
                            <th>Nome do Produto</th>
                            <th>Unidades Vendidas</th>
                            <th>Preço Base</th>
                            <th>Preço Total</th>
                            <th>Semana</th>
                            <th>ID Loja</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- JavaScript will insert rows here -->
                    </tbody>
                </table>
            </div>
        </main>
    </div>

    <script>
document.addEventListener('DOMContentLoaded', function () {
    let allData = [];

    const tbody = document.querySelector('tbody');
    const searchInput = document.querySelector('.search-input');

    function renderTable(data) {
        tbody.innerHTML = '';

        if (!data || data.length === 0) {
            tbody.innerHTML = '<tr><td colspan="7">Nenhum produto encontrado.</td></tr>';
            return;
        }

        data.forEach(item => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${item.sku_id || '-'}</td>
                <td>${item.product_name || '-'}</td>
                <td>${item.units_sold || '-'}</td>
                <td>${item.base_price || '-'}</td>
                <td>${item.total_price || '-'}</td>
                <td>${item.week || '-'}</td>
                <td>${item.store_id || '-'}</td>
            `;
            tbody.appendChild(row);
        });
    }

    fetch('http://localhost:5000/api/inventory')
        .then(response => response.json())
        .then(data => {
            allData = data;
            renderTable(allData);
        })
        .catch(error => {
            console.error('Erro ao buscar os dados:', error);
        });

    searchInput.addEventListener('input', function () {
        const query = this.value.toLowerCase();

        const filtered = allData.filter(item =>
            (item.product_name || '').toLowerCase().includes(query)
        );

        renderTable(filtered);
    });
});
</script>

</body>
</html>
